<!DOCTYPE html>
<html>

<head>
	<title>CISC325</title>
	<meta charset="utf-8" />
	<meta name="Yu" content=""/>
	<link href="https://fonts.googleapis.com/css?family=PT+Serif|Josefin+Sans" rel="stylesheet"> 
	<link rel="stylesheet" href="css/style.css">		
	<link rel="stylesheet" href="css/responsive.css">	
	<link rel="stylesheet" href="css/signup.css">	
	<script src="./js/data.js"></script>
	<script src="./data/event.js"></script>
</head>

<body>
	<header>
		<nav>
			<ul>		
				<li><a href="./index.html">Home</a></li>
				<li><a href="./login.html">Login</a></li>
			</ul>		
		</nav>
	</header>
	
	<article id="main-content">
		
		<div id = "form">
			<h1 style = "font-size:18px; margin-bottom: 15px;">Complete your information to sign up for an appointment.</h1>
			<label for="Sname">Student name:</label>
			<input type="text" id="Sname" name="Sname" value="name"><br><br>
			<label for="date">Date:</label>
			<input type="text" id="date" name="date" readonly><br><br>
			<label for="ta">TA:</label>
			<input type="text" id="ta" name="ta" readonly><br><br>
			<label for="time">Time:</label>
			<input type="text" id="time" name="time" readonly><br><br>
			<label for="question">Question Description</label>
			<textarea id="question" name="question">write something.</textarea>
			<br></br>
			<button style ="border-radius: 15%" ; id="signUpButton" onclick = "submit()">Submit</button>
		</div>
		<div id = "verticalLine"></div>
		
		<table id = "timeSlots" align="right">
			<tr>
				<th id = "tableTitle"></th>
			</tr>
			<tr>
				<td onclick = "clickSlots()" id = "0"></td>
			</tr>
			<tr>
				<td onclick = "clickSlots()" id = "1">  </td>
			</tr>
			<tr>
				<td onclick = "clickSlots()" id = "2"></td>
			</tr>
			<tr>
				<td onclick = "clickSlots()" id = "3"></td>
			</tr>
			<tr>
				<td onclick = "clickSlots()" id = "4">  </td>
			</tr>
			<tr>
				<td onclick = "clickSlots()" id = "5">  </td>
			</tr>
			<tr>
				<td onclick = "clickSlots()" id = "6">  </td>
			</tr>
		</table>
			
	</article> <!-- #main-content -->
	
	<footer>
		<div>
		
		</div>
	</footer>
	
	<script>
		var dict = {
				1 : "January",
				2 : "February",
				3 : "March",
				4 : "April",
				5 : "May",
				6 : "June",
				7 : "July",
				8 : "August",
				9 : "September",
				10 : "October",
				11 : "November",
				12 : "December"
		}	
		var info = sessionStorage.getItem("year-month-day").split("-");
		var date = "Schedule for " + dict[info[1]] + " " + info[2];
		var dateChosen = new Date(info[0],info[1] - 1,info[2]);
		var today = dateChosen.getDay();
		
		document.getElementById("date").setAttribute('value',sessionStorage.getItem("year-month-day"));
		document.getElementById("tableTitle").innerHTML = date;
		
		var line = taTime[today];
		var str = line.split(",");
		for(var i = 0;i < str.length;i++){
			document.getElementById("timeSlots").rows[i+1].cells[0].innerHTML = str[i].replace("/"," ");
		}
		
		function clickSlots(){
			var target = event.target;
			var id = target.id;
			document.getElementById("ta").setAttribute('value',str[id].split("/")[0]);
			document.getElementById("time").setAttribute('value',str[id].split("/")[1]);
		}
		
		function submit(){
			var signupInfo = [];
			signupInfo.push(document.getElementById("Sname").value);
			signupInfo.push(document.getElementById("date").value);
			signupInfo.push(document.getElementById("ta").value);
			signupInfo.push(document.getElementById("time").value);
			signupInfo.push(document.getElementById("question").value);
			var infoStr = "" + signupInfo;
			var newStr = ""
			newStr = newStr + sessionStorage.getItem("eventData");
			if(newStr.includes(infoStr) == true){
				confirm("You have made an appointment at this time.")
			}else{
				if(newStr == "" || newStr == null){
					newStr = signupInfo;
				}else{
					newStr = newStr +  "//" + signupInfo;
				}
				sessionStorage.setItem("eventData",newStr);
				confirm("Successful! You have made an appointment.");
				window.location.href = "./calendar.html";
			}
		}
	</script>
	
</body>
</html>
